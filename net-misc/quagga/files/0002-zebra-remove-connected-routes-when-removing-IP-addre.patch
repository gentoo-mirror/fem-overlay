From e74d43a65b7e06a0d73bd669a085b98f540f42e9 Mon Sep 17 00:00:00 2001
From: Paul Evans <paul@mxtelecom.com>
Date: Mon, 6 Sep 2010 13:46:19 +0200
Subject: [PATCH 2/3] zebra: remove connected routes when removing IP address
 from interface.
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Fix for upstream quagga bug #486

https://bugzilla.quagga.net/show_bug.cgi?id=486

Signed-off-by: Diego Elio Petten√≤ <flameeyes@flameeyes.eu>
---
 zebra/interface.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/zebra/interface.c b/zebra/interface.c
index 03e7ff7..182caa5 100644
--- a/zebra/interface.c
+++ b/zebra/interface.c
@@ -1284,17 +1284,17 @@ ip_address_uninstall (struct vty *vty, struct interface *ifp,
       return CMD_WARNING;
     }
 
-#if 0
   /* Redistribute this information. */
   zebra_interface_address_delete_update (ifp, ifc);
 
   /* Remove connected route. */
   connected_down_ipv4 (ifp, ifc);
 
+  if_subnet_delete(ifp, ifc);
+
   /* Free address information. */
   listnode_delete (ifp->connected, ifc);
   connected_free (ifc);
-#endif
 
   return CMD_SUCCESS;
 }
-- 
1.7.7

